@startuml reflection-pattern
!include ../../config/_standard-style.puml

title Reflection Pattern: Self-Improvement Through Criticism

actor "User" as user
participant "Agent" as agent
participant "LLM (Generate)" as llm_gen
participant "LLM (Reflect)" as llm_reflect

user -> agent : "Write a technical blog post about AI agents"

activate agent
agent -> llm_gen : Generate initial content
activate llm_gen
llm_gen -> agent : Initial draft
deactivate llm_gen

note over agent : Iteration 1

agent -> llm_reflect : "Review this draft:\n- Is it technically accurate?\n- Does it engage readers?\n- What's missing?"
activate llm_reflect
llm_reflect -> agent : "Good technical content but lacks\npractical examples. Structure needs\nimprovement. Add code samples."
deactivate llm_reflect

agent -> llm_gen : Refine based on critique
activate llm_gen
llm_gen -> agent : Improved draft v2
deactivate llm_gen

note over agent : Iteration 2

agent -> llm_reflect : "Review updated version"
activate llm_reflect
llm_reflect -> agent : "Much better! Code examples help.\nConsider adding a conclusion\nsection and call-to-action."
deactivate llm_reflect

agent -> llm_gen : Final refinement
activate llm_gen
llm_gen -> agent : Final polished article
deactivate llm_gen

agent -> user : High-quality blog post with:\n• Clear technical explanations\n• Practical code examples\n• Engaging structure\n• Strong conclusion
deactivate agent

note right of agent : Benefits:\n• Higher quality outputs\n• Self-improving system\n• Catches errors and omissions\n• Builds confidence in results

@enduml
@startuml advanced-workflow-architecture

!include ../../../config/_standard-style.puml

title Advanced Workflow Architecture

package "Workflow Engine Core" {
  [AdvancedWorkflowEngine] as engine
  [WorkflowOptimizer] as optimizer
  [ResourceManager] as resource
  [MetricsCollector] as metrics
}

package "Execution Patterns" {
  [SequentialExecution] as sequential
  [ParallelExecution] as parallel
  [ConditionalExecution] as conditional
  [LoopExecution] as loop
  [HybridExecution] as hybrid
}

package "Agent Integration" {
  [AgentRegistry] as registry
  [A2ARouter] as router
  [MCPClients] as mcp
  [CapabilityMatcher] as matcher
}

package "Monitoring & Observability" {
  [PerformanceMetrics] as perf
  [HealthChecker] as health
  [AlertManager] as alerts
  [DistributedTracing] as tracing
}

package "External Systems" {
  database "Redis\nCluster" as redis
  cloud "Cloud\nServices" as cloud
  agent "External\nAgents" as external
}

' Core connections
engine --> optimizer : "Performance Data"
engine --> resource : "Resource Requests"
engine --> metrics : "Execution Metrics"

' Execution pattern connections
engine --> sequential
engine --> parallel
engine --> conditional
engine --> loop
engine --> hybrid

' Agent integration
engine --> registry : "Agent Discovery"
engine --> router : "Message Routing"
engine --> mcp : "Tool Calls"
engine --> matcher : "Capability Matching"

' Monitoring connections
engine --> perf : "Metrics"
engine --> health : "Health Status"
optimizer --> alerts : "Optimization Alerts"
metrics --> tracing : "Trace Data"

' External system connections
registry --> redis : "Agent State"
router --> redis : "Message Queue"
mcp --> cloud : "External APIs"
router --> external : "Inter-Agent Comm"

' Data flows
perf --> optimizer : "Historical Data"
health --> alerts : "Health Events"
metrics --> perf : "Raw Metrics"

@enduml